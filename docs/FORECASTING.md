# Forecasting Foundations

## Feature Policy & Leakage

The intraday feature stack is anchored on return-space targets to avoid scale drift and to keep the prediction target stationary. Minute close-to-close log returns define the default label (`target_log_return_1m`), while predictor columns are strictly sourced from information available at or before the feature timestamp. Rolling windows never peek forward: momentum (`ret_1m/5m/15m`), realised variance (`rv_5m/15m`), ATR, and Parkinson / Garman–Klass volatility are all computed with past bars only. Volume-sensitive signals (`VWAP_30m`, `z_close_vwap_30m`, `vol_5m_norm`) normalise intraday liquidity by recent history, ensuring each row represents the state just prior to the forecast horizon. Deterministic components expose an explicit `minute_index`, Fourier harmonics, and session buckets—fully reproducible from the timestamp and trading calendar—while contextual enrichments keep SPY factors lagged by one minute and layer on regime flags and event dummies (earnings/FOMC/CPI). After the feature pass we drop any row where the NaN share exceeds 1%, guaranteeing downstream models see leakage-safe and numerically stable matrices stored under `artifacts/runs/<run_id>/features/`.
